"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{8867:(e,t,a)=>{a.d(t,{A:()=>i});let i=(0,a(7401).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},3580:(e,t,a)=>{a.d(t,{A:()=>i});let i=(0,a(7401).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},8938:(e,t,a)=>{a.d(t,{A:()=>w});var i=a(5155),s=a(2115),r=a(5565),l=a(1594),d=a(3580),o=a(3920),n=a(2598),c=a(5686),u=a(767),p=a(8684),m=a(8867),g=a(5683),h=a(9219),f=a(5953),x=a(6009);let y={publicKey:"public_2BXoL4/MDWL0GjI21rq6iIG1TF8="};async function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await fetch("/api/imagekit/auth");if(!a.ok)throw Error("Failed to get authentication parameters");let i=await a.json(),s=new FormData;s.append("file",e),s.append("publicKey",y.publicKey),s.append("signature",i.signature),s.append("expire",i.expire),s.append("token",i.token),t.fileName&&s.append("fileName",t.fileName),t.folder&&s.append("folder",t.folder),void 0!==t.useUniqueFileName&&s.append("useUniqueFileName",t.useUniqueFileName.toString()),t.tags&&t.tags.length>0&&s.append("tags",t.tags.join(",")),t.customMetadata&&s.append("customMetadata",JSON.stringify(t.customMetadata));let r=new XMLHttpRequest;return new Promise(e=>{r.upload.addEventListener("progress",e=>{if(e.lengthComputable&&t.onProgress){let a=Math.round(e.loaded/e.total*100);t.onProgress(a)}}),r.addEventListener("load",()=>{try{if(200===r.status){let t=JSON.parse(r.responseText);e({success:!0,url:t.url,fileId:t.fileId,width:t.width,height:t.height})}else{let t=JSON.parse(r.responseText);e({success:!1,error:t.message||"Upload failed"})}}catch(t){e({success:!1,error:"Failed to parse response"})}}),r.addEventListener("error",()=>{e({success:!1,error:"Network error during upload"})}),r.open("POST","https://upload.imagekit.io/api/v1/files/upload"),r.send(s)})}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}function w(e){let{src:t,alt:a,className:y="",sizes:w="100vw",onUpdate:j,onDelete:v,category:N="general",priority:S=!1,quality:M=85,showEditButton:A=!0,aspectRatio:I,placeholder:k="empty",blurDataURL:P,enableCMS:D=!0,mediaId:F}=e,{isAdmin:z}=(0,f.A)(),{addMedia:U,deleteMedia:O,addActivity:C,addError:E}=(0,x.A)(),[L,T]=(0,s.useState)(!1),[R,q]=(0,s.useState)(!1),[_,B]=(0,s.useState)(0),[Q,G]=(0,s.useState)(null),[J,W]=(0,s.useState)(!1),[K,V]=(0,s.useState)(t),X=(0,s.useRef)(null),H=(0,s.useCallback)(e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(!["image/jpeg","image/jpg","image/png","image/webp","image/avif"].includes(a.type)){G("Invalid file type. Please select a JPEG, PNG, WebP, or AVIF image.");return}if(a.size>0xa00000){G("File size too large. Please select an image under 10MB.");return}Z(a)}},[]),Z=async e=>{q(!0),B(0),G(null);try{let t="img_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i=await b(e,{folder:N,fileName:"".concat(t,"_").concat(e.name),useUniqueFileName:!0,onProgress:e=>{B(e)}});if(i.success&&i.url){let s={id:t,url:i.url,type:"image",alt:a||e.name,title:e.name,category:N,folder:N,width:i.width||0,height:i.height||0,size:e.size,uploadedAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tags:[],metadata:{originalName:e.name,fileType:e.type,...i}};D&&(U(s),C({userId:"admin",action:"upload",entityType:"media",entityId:s.id,details:"Uploaded image: ".concat(e.name," to ").concat(N)})),V(i.url),j&&j(i.url),B(100),setTimeout(()=>{q(!1),B(0)},1e3)}else throw Error(i.error||"Upload failed")}catch(t){G(t instanceof Error?t.message:"Upload failed"),E("Failed to upload ".concat(e.name,": ").concat(t instanceof Error?t.message:"Unknown error")),q(!1),B(0)}},Y=e=>{if(!e)return"/images/placeholder.jpg";if(e.startsWith("http"))return e;let t="https://ik.imagekit.io/t914/";return t?"".concat(t).concat(e.startsWith("/")?e:"/".concat(e),"?w=1920&q=").concat(M,"&f=auto"):e};return z?(0,i.jsxs)("div",{className:"relative group ".concat(I?"aspect-[".concat(I,"]"):""," ").concat(y),onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:[(0,i.jsx)("input",{ref:X,type:"file",accept:"image/*",onChange:H,className:"hidden"}),(0,i.jsx)(r.default,{src:Y(K),alt:a,fill:!0,className:"object-cover transition-all duration-300 group-hover:brightness-75",sizes:w,priority:S,quality:M,placeholder:k,blurDataURL:P,onError:()=>V("/images/placeholder.jpg")}),(0,i.jsx)(g.N,{children:R&&(0,i.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-20",children:(0,i.jsxs)("div",{className:"text-center text-white",children:[(0,i.jsx)("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mb-4 mx-auto"}),(0,i.jsx)("p",{className:"text-sm font-medium",children:"Uploading..."}),(0,i.jsxs)("p",{className:"text-xs text-gray-300 mt-1",children:[_,"%"]}),(0,i.jsx)("div",{className:"w-32 h-1 bg-white/30 rounded-full mt-2 overflow-hidden",children:(0,i.jsx)(h.P.div,{className:"h-full bg-white rounded-full",initial:{width:"0%"},animate:{width:"".concat(_,"%")},transition:{duration:.3}})})]})})}),(0,i.jsx)(g.N,{children:Q&&(0,i.jsx)(h.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute inset-0 bg-red-500/90 backdrop-blur-sm flex items-center justify-center z-20",children:(0,i.jsxs)("div",{className:"text-center text-white p-4",children:[(0,i.jsx)(l.A,{size:24,className:"mx-auto mb-2"}),(0,i.jsx)("p",{className:"text-sm font-medium mb-2",children:"Upload Error"}),(0,i.jsx)("p",{className:"text-xs",children:Q}),(0,i.jsx)("button",{onClick:()=>G(null),className:"mt-2 px-3 py-1 bg-white/20 rounded-lg text-xs hover:bg-white/30 transition-colors",children:"Dismiss"})]})})}),(0,i.jsx)(g.N,{children:L&&A&&!R&&(0,i.jsx)(h.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-10",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>{var e;null===(e=X.current)||void 0===e||e.click()},className:"p-2 bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors",title:"Replace Image",children:(0,i.jsx)(d.A,{size:16,className:"text-white"})}),D&&F&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{D&&F&&C({userId:"admin",action:"edit",entityType:"media",entityId:F,details:"Duplicated image: ".concat(a)})},className:"p-2 bg-green-500 hover:bg-green-600 rounded-lg transition-colors",title:"Duplicate Image",children:(0,i.jsx)(o.A,{size:16,className:"text-white"})}),(0,i.jsx)("button",{onClick:()=>W(!J),className:"p-2 bg-purple-500 hover:bg-purple-600 rounded-lg transition-colors",title:"More Actions",children:(0,i.jsx)(n.A,{size:16,className:"text-white"})})]}),v&&(0,i.jsx)("button",{onClick:()=>{v&&v(),D&&F&&(O(F),C({userId:"admin",action:"delete",entityType:"media",entityId:F,details:"Deleted image: ".concat(a)}))},className:"p-2 bg-red-500 hover:bg-red-600 rounded-lg transition-colors",title:"Delete Image",children:(0,i.jsx)(c.A,{size:16,className:"text-white"})})]})})}),(0,i.jsx)(g.N,{children:J&&D&&(0,i.jsxs)(h.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute top-4 right-4 bg-black/90 backdrop-blur-sm rounded-lg p-3 z-30 min-w-48",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsx)("h4",{className:"text-white text-sm font-medium",children:"Image Actions"}),(0,i.jsx)("button",{onClick:()=>W(!1),className:"text-gray-400 hover:text-white",children:(0,i.jsx)(u.A,{size:14})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(K),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-white hover:bg-white/10 rounded transition-colors",children:[(0,i.jsx)(o.A,{size:12}),"Copy URL"]}),(0,i.jsxs)("button",{onClick:()=>window.open(K,"_blank"),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-white hover:bg-white/10 rounded transition-colors",children:[(0,i.jsx)(n.A,{size:12}),"View Full Size"]}),(0,i.jsxs)("div",{className:"border-t border-gray-600 pt-2",children:[(0,i.jsxs)("p",{className:"text-xs text-gray-400 mb-1",children:["Category: ",N]}),F&&(0,i.jsxs)("p",{className:"text-xs text-gray-400",children:["ID: ",F]})]})]})]})}),R&&(0,i.jsx)("div",{className:"absolute top-2 right-2 z-30",children:(0,i.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:(0,i.jsx)(p.A,{size:12,className:"text-white"})})}),100===_&&(0,i.jsx)(h.P.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute top-2 right-2 z-30",children:(0,i.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,i.jsx)(m.A,{size:12,className:"text-white"})})})]}):(0,i.jsx)("div",{className:"relative ".concat(I?"aspect-[".concat(I,"]"):""," ").concat(y),children:(0,i.jsx)(r.default,{src:Y(K),alt:a,fill:!0,className:"object-cover",sizes:w,priority:S,quality:M,placeholder:k,blurDataURL:P,onError:()=>V("/images/placeholder.jpg")})})}},6009:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(9827),s=a(709);let r=(0,i.v)()((0,s.Zr)((e,t)=>({media:{},folders:{root:{id:"root",name:"Root",path:"/",isPrivate:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},designers:{id:"designers",name:"Designers",path:"/designers",parentId:"root",isPrivate:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},projects:{id:"projects",name:"Projects",path:"/projects",parentId:"root",isPrivate:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},about:{id:"about",name:"About",path:"/about",parentId:"root",isPrivate:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},general:{id:"general",name:"General",path:"/general",parentId:"root",isPrivate:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},selectedMedia:[],currentFolder:"root",searchQuery:"",filters:{},uploads:{inProgress:{},completed:[],failed:{}},currentUser:null,users:{},activities:[],settings:{maxFileSize:0xa00000,allowedTypes:["image/jpeg","image/png","image/webp","image/avif","video/mp4","video/webm"],autoBackup:!0,compressionQuality:85},isLoading:!1,errors:[],addMedia:t=>e(e=>({media:{...e.media,[t.id]:t}})),updateMedia:(t,a)=>e(e=>({media:{...e.media,[t]:e.media[t]?{...e.media[t],...a,updatedAt:new Date().toISOString()}:e.media[t]}})),deleteMedia:t=>e(e=>{let a={...e.media};return delete a[t],{media:a,selectedMedia:e.selectedMedia.filter(e=>e!==t)}}),bulkDeleteMedia:t=>e(e=>{let a={...e.media};return t.forEach(e=>delete a[e]),{media:a,selectedMedia:e.selectedMedia.filter(e=>!t.includes(e))}}),moveMedia:(t,a)=>e(e=>{let i={...e.media};return t.forEach(e=>{i[e]&&(i[e]={...i[e],folder:a,updatedAt:new Date().toISOString()})}),{media:i}}),duplicateMedia:t=>e(e=>{let a=e.media[t];if(!a)return e;let i={...a,id:"".concat(t,"-copy-").concat(Date.now()),title:"".concat(a.title||"Untitled"," (Copy)"),uploadedAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return{media:{...e.media,[i.id]:i}}}),selectMedia:t=>e(e=>({selectedMedia:e.selectedMedia.includes(t)?e.selectedMedia:[...e.selectedMedia,t]})),deselectMedia:t=>e(e=>({selectedMedia:e.selectedMedia.filter(e=>e!==t)})),selectAllMedia:()=>e(e=>({selectedMedia:t().getMediaByFolder(e.currentFolder).map(e=>e.id)})),clearSelection:()=>e({selectedMedia:[]}),toggleMediaSelection:t=>e(e=>({selectedMedia:e.selectedMedia.includes(t)?e.selectedMedia.filter(e=>e!==t):[...e.selectedMedia,t]})),addFolder:t=>e(e=>({folders:{...e.folders,[t.id]:t}})),updateFolder:(t,a)=>e(e=>({folders:{...e.folders,[t]:e.folders[t]?{...e.folders[t],...a,updatedAt:new Date().toISOString()}:e.folders[t]}})),deleteFolder:t=>e(e=>{let a={...e.folders};return delete a[t],{folders:a}}),setCurrentFolder:t=>e({currentFolder:t,selectedMedia:[]}),setSearchQuery:t=>e({searchQuery:t}),setFilters:t=>e(e=>({filters:{...e.filters,...t}})),clearFilters:()=>e({filters:{},searchQuery:""}),startUpload:(t,a)=>e(e=>({uploads:{...e.uploads,inProgress:{...e.uploads.inProgress,[t]:{progress:0,file:a}}}})),updateUploadProgress:(t,a)=>e(e=>({uploads:{...e.uploads,inProgress:{...e.uploads.inProgress,[t]:e.uploads.inProgress[t]?{...e.uploads.inProgress[t],progress:a}:e.uploads.inProgress[t]}}})),completeUpload:(t,a)=>e(e=>{let i={...e.uploads.inProgress};return delete i[t],{media:{...e.media,[a.id]:a},uploads:{...e.uploads,inProgress:i,completed:[...e.uploads.completed,t]}}}),failUpload:(t,a)=>e(e=>{let i={...e.uploads.inProgress};return delete i[t],{uploads:{...e.uploads,inProgress:i,failed:{...e.uploads.failed,[t]:a}}}}),clearUploads:()=>e(()=>({uploads:{inProgress:{},completed:[],failed:{}}})),setCurrentUser:t=>e({currentUser:t}),updateUser:(t,a)=>e(e=>({users:{...e.users,[t]:e.users[t]?{...e.users[t],...a}:e.users[t]}})),addActivity:t=>e(e=>({activities:[{...t,id:"activity-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),timestamp:new Date().toISOString()},...e.activities.slice(0,99)]})),setLoading:t=>e({isLoading:t}),addError:t=>e(e=>({errors:[...e.errors,t]})),clearErrors:()=>e({errors:[]}),getMediaByFolder:e=>Object.values(t().media).filter(t=>t.folder===e),getFilteredMedia:()=>{let e=t();return(e.getMediaByFolder?e.getMediaByFolder(e.currentFolder):[]).filter(t=>{if(e.searchQuery){let a=e.searchQuery.toLowerCase();if(![t.title,t.alt,t.description,...t.tags].filter(Boolean).join(" ").toLowerCase().includes(a))return!1}if(e.filters.type&&t.type!==e.filters.type||e.filters.category&&t.category!==e.filters.category||e.filters.tags&&e.filters.tags.length>0&&!e.filters.tags.some(e=>t.tags.includes(e)))return!1;if(e.filters.dateRange){let a=new Date(t.uploadedAt),i=new Date(e.filters.dateRange.start),s=new Date(e.filters.dateRange.end);if(a<i||a>s)return!1}return!0})},getMediaStats:()=>{let e=Object.values(t().media);return{total:e.length,images:e.filter(e=>"image"===e.type).length,videos:e.filter(e=>"video"===e.type).length,totalSize:e.reduce((e,t)=>e+t.size,0)}}}),{name:"redux-cms-store",partialize:e=>({media:e.media,folders:e.folders,currentUser:e.currentUser,users:e.users,activities:e.activities,settings:e.settings})}))}}]);