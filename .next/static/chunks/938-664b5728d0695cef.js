"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{8867:(e,t,a)=>{a.d(t,{A:()=>i});let i=(0,a(7401).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},1594:(e,t,a)=>{a.d(t,{A:()=>i});let i=(0,a(7401).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3580:(e,t,a)=>{a.d(t,{A:()=>i});let i=(0,a(7401).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},8938:(e,t,a)=>{a.d(t,{A:()=>j});var i=a(5155),s=a(2115),l=a(5565),r=a(1594),n=a(3580),c=a(3920),o=a(2598),d=a(5686),u=a(767),m=a(8684),p=a(8867),h=a(5683),x=a(9219),g=a(5953),b=a(6009);let f={publicKey:"public_2BXoL4/MDWL0GjI21rq6iIG1TF8="};async function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await fetch("/api/imagekit/auth");if(!a.ok)throw Error("Failed to get authentication parameters");let i=await a.json(),s=new FormData;s.append("file",e),s.append("publicKey",f.publicKey),s.append("signature",i.signature),s.append("expire",i.expire),s.append("token",i.token),t.fileName&&s.append("fileName",t.fileName),t.folder&&s.append("folder",t.folder),void 0!==t.useUniqueFileName&&s.append("useUniqueFileName",t.useUniqueFileName.toString()),t.tags&&t.tags.length>0&&s.append("tags",t.tags.join(",")),t.customMetadata&&s.append("customMetadata",JSON.stringify(t.customMetadata));let l=new XMLHttpRequest;return new Promise(e=>{l.upload.addEventListener("progress",e=>{if(e.lengthComputable&&t.onProgress){let a=Math.round(e.loaded/e.total*100);t.onProgress(a)}}),l.addEventListener("load",()=>{try{if(200===l.status){let t=JSON.parse(l.responseText);e({success:!0,url:t.url,fileId:t.fileId,width:t.width,height:t.height})}else{let t=JSON.parse(l.responseText);e({success:!1,error:t.message||"Upload failed"})}}catch(t){e({success:!1,error:"Failed to parse response"})}}),l.addEventListener("error",()=>{e({success:!1,error:"Network error during upload"})}),l.open("POST","https://upload.imagekit.io/api/v1/files/upload"),l.send(s)})}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}function j(e){let{src:t,alt:a,className:f="",sizes:j="100vw",onUpdate:N,onDelete:w,category:v="general",priority:k=!1,quality:A=85,showEditButton:z=!0,aspectRatio:I,placeholder:C="empty",blurDataURL:P,enableCMS:S=!0,mediaId:E}=e,{isAdmin:U}=(0,g.A)(),{addMedia:D,deleteMedia:F,addActivity:M,addError:L}=(0,b.A)(),[q,T]=(0,s.useState)(!1),[_,O]=(0,s.useState)(!1),[R,G]=(0,s.useState)(0),[J,W]=(0,s.useState)(null),[K,B]=(0,s.useState)(!1),[V,X]=(0,s.useState)(t),H=(0,s.useRef)(null),Q=(0,s.useCallback)(e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(!["image/jpeg","image/jpg","image/png","image/webp","image/avif"].includes(a.type)){W("Invalid file type. Please select a JPEG, PNG, WebP, or AVIF image.");return}if(a.size>0xa00000){W("File size too large. Please select an image under 10MB.");return}Y(a)}},[]),Y=async e=>{O(!0),G(0),W(null);try{let t="img_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i=await y(e,{folder:v,fileName:"".concat(t,"_").concat(e.name),useUniqueFileName:!0,onProgress:e=>{G(e)}});if(i.success&&i.url){let s={id:t,url:i.url,type:"image",alt:a||e.name,title:e.name,category:v,folder:v,width:i.width||0,height:i.height||0,size:e.size,uploadedAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tags:[],metadata:{originalName:e.name,fileType:e.type,...i}};S&&(D(s),M({userId:"admin",action:"upload",entityType:"media",entityId:s.id,details:"Uploaded image: ".concat(e.name," to ").concat(v)})),X(i.url),N&&N(i.url),G(100),setTimeout(()=>{O(!1),G(0)},1e3)}else throw Error(i.error||"Upload failed")}catch(t){W(t instanceof Error?t.message:"Upload failed"),L("Failed to upload ".concat(e.name,": ").concat(t instanceof Error?t.message:"Unknown error")),O(!1),G(0)}},Z=e=>{if(!e)return"/images/placeholder.jpg";if(e.startsWith("http"))return e;let t="https://ik.imagekit.io/t914/";return t?"".concat(t).concat(e.startsWith("/")?e:"/".concat(e),"?w=1920&q=").concat(A,"&f=auto"):e};return U?(0,i.jsxs)("div",{className:"relative group ".concat(I?"aspect-[".concat(I,"]"):""," ").concat(f),onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:[(0,i.jsx)("input",{ref:H,type:"file",accept:"image/*",onChange:Q,className:"hidden"}),(0,i.jsx)(l.default,{src:Z(V),alt:a,fill:!0,className:"object-cover transition-all duration-300 group-hover:brightness-75",sizes:j,priority:k,quality:A,placeholder:C,blurDataURL:P,onError:()=>X("/images/placeholder.jpg")}),(0,i.jsx)(h.N,{children:_&&(0,i.jsx)(x.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-20",children:(0,i.jsxs)("div",{className:"text-center text-white",children:[(0,i.jsx)("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mb-4 mx-auto"}),(0,i.jsx)("p",{className:"text-sm font-medium",children:"Uploading..."}),(0,i.jsxs)("p",{className:"text-xs text-gray-300 mt-1",children:[R,"%"]}),(0,i.jsx)("div",{className:"w-32 h-1 bg-white/30 rounded-full mt-2 overflow-hidden",children:(0,i.jsx)(x.P.div,{className:"h-full bg-white rounded-full",initial:{width:"0%"},animate:{width:"".concat(R,"%")},transition:{duration:.3}})})]})})}),(0,i.jsx)(h.N,{children:J&&(0,i.jsx)(x.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute inset-0 bg-red-500/90 backdrop-blur-sm flex items-center justify-center z-20",children:(0,i.jsxs)("div",{className:"text-center text-white p-4",children:[(0,i.jsx)(r.A,{size:24,className:"mx-auto mb-2"}),(0,i.jsx)("p",{className:"text-sm font-medium mb-2",children:"Upload Error"}),(0,i.jsx)("p",{className:"text-xs",children:J}),(0,i.jsx)("button",{onClick:()=>W(null),className:"mt-2 px-3 py-1 bg-white/20 rounded-lg text-xs hover:bg-white/30 transition-colors",children:"Dismiss"})]})})}),(0,i.jsx)(h.N,{children:q&&z&&!_&&(0,i.jsx)(x.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-10",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>{var e;null===(e=H.current)||void 0===e||e.click()},className:"p-2 bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors",title:"Replace Image",children:(0,i.jsx)(n.A,{size:16,className:"text-white"})}),S&&E&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{S&&E&&M({userId:"admin",action:"edit",entityType:"media",entityId:E,details:"Duplicated image: ".concat(a)})},className:"p-2 bg-green-500 hover:bg-green-600 rounded-lg transition-colors",title:"Duplicate Image",children:(0,i.jsx)(c.A,{size:16,className:"text-white"})}),(0,i.jsx)("button",{onClick:()=>B(!K),className:"p-2 bg-purple-500 hover:bg-purple-600 rounded-lg transition-colors",title:"More Actions",children:(0,i.jsx)(o.A,{size:16,className:"text-white"})})]}),w&&(0,i.jsx)("button",{onClick:()=>{w&&w(),S&&E&&(F(E),M({userId:"admin",action:"delete",entityType:"media",entityId:E,details:"Deleted image: ".concat(a)}))},className:"p-2 bg-red-500 hover:bg-red-600 rounded-lg transition-colors",title:"Delete Image",children:(0,i.jsx)(d.A,{size:16,className:"text-white"})})]})})}),(0,i.jsx)(h.N,{children:K&&S&&(0,i.jsxs)(x.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute top-4 right-4 bg-black/90 backdrop-blur-sm rounded-lg p-3 z-30 min-w-48",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsx)("h4",{className:"text-white text-sm font-medium",children:"Image Actions"}),(0,i.jsx)("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-white",children:(0,i.jsx)(u.A,{size:14})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(V),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-white hover:bg-white/10 rounded transition-colors",children:[(0,i.jsx)(c.A,{size:12}),"Copy URL"]}),(0,i.jsxs)("button",{onClick:()=>window.open(V,"_blank"),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-white hover:bg-white/10 rounded transition-colors",children:[(0,i.jsx)(o.A,{size:12}),"View Full Size"]}),(0,i.jsxs)("div",{className:"border-t border-gray-600 pt-2",children:[(0,i.jsxs)("p",{className:"text-xs text-gray-400 mb-1",children:["Category: ",v]}),E&&(0,i.jsxs)("p",{className:"text-xs text-gray-400",children:["ID: ",E]})]})]})]})}),_&&(0,i.jsx)("div",{className:"absolute top-2 right-2 z-30",children:(0,i.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:(0,i.jsx)(m.A,{size:12,className:"text-white"})})}),100===R&&(0,i.jsx)(x.P.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute top-2 right-2 z-30",children:(0,i.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,i.jsx)(p.A,{size:12,className:"text-white"})})})]}):(0,i.jsx)("div",{className:"relative ".concat(I?"aspect-[".concat(I,"]"):""," ").concat(f),children:(0,i.jsx)(l.default,{src:Z(V),alt:a,fill:!0,className:"object-cover",sizes:j,priority:k,quality:A,placeholder:C,blurDataURL:P,onError:()=>X("/images/placeholder.jpg")})})}}}]);