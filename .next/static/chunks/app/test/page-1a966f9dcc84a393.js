(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{36708:(e,l,t)=>{Promise.resolve().then(t.bind(t,63806))},63806:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>u});var a=t(95155),i=t(12115),s=t(25683),r=t(25427),n=t(86989),c=t(33227),d=t(91653);function o(e){let{images:l,folder:t,className:o="",maxVisible:h=3,onImagesUpdate:u}=e,[m,x]=(0,i.useState)(l),[p,g]=(0,i.useState)(!1),f=(0,i.useRef)(null),{isAdmin:j}=(0,n.z)(),{success:y,error:b}=(0,c.d)(),v=m.slice(0,h),w=m.length>h,N=async e=>{if(!e.length)return;let l=Array.from(e).map(async(e,l)=>{let a=new FormData;a.append("file",e),a.append("folder",t);try{let t=await fetch("/api/imagekit/upload",{method:"POST",body:a});if(t.ok){let a=await t.json();return{id:"".concat(Date.now(),"-").concat(l),src:a.url,alt:e.name}}throw Error("Upload failed")}catch(l){return b("".concat(e.name," 업로드에 실패했습니다.")),null}}),a=(await Promise.all(l)).filter(Boolean);if(a.length>0){let e=[...m,...a];x(e),null==u||u(e),y("".concat(a.length,"개 이미지가 추가되었습니다."))}},k=e=>{let l=m.filter(l=>l.id!==e);x(l),null==u||u(l),y("이미지가 제거되었습니다.")};return(0,a.jsxs)("div",{className:"relative ".concat(o),children:[(0,a.jsxs)("div",{className:"relative aspect-square cursor-pointer",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[(0,a.jsx)(s.N,{children:v.map((e,l)=>(0,a.jsxs)(r.P.div,{className:"absolute inset-0 rounded-lg overflow-hidden shadow-lg bg-white",initial:{rotate:0,scale:1,x:0,y:0},animate:{rotate:p?8*l-8:5*l-5,scale:p?1-.02*l:1-.05*l,x:p?25*l:0,y:p?5*l:-3*l},transition:{duration:.4,ease:"easeOut",delay:p?.1*l:0},style:{zIndex:v.length-l,transformOrigin:"bottom center"},children:[(0,a.jsx)(d.A,{src:e.src,alt:e.alt,fill:!0,className:"object-cover",folder:t,sizes:"(max-width: 768px) 100vw, 50vw"}),j&&p&&(0,a.jsx)(r.P.button,{className:"absolute top-2 right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-600 transition-colors z-10",onClick:l=>{l.stopPropagation(),k(e.id)},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{delay:.1*l+.2},children:"\xd7"})]},e.id))}),w&&(0,a.jsxs)(r.P.div,{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded-full backdrop-blur-sm",initial:{opacity:0},animate:{opacity:p?1:.7},transition:{duration:.3},children:["+",m.length-h]}),j&&(0,a.jsx)(r.P.div,{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-lg",whileHover:{opacity:1},children:(0,a.jsx)(r.P.button,{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white text-2xl hover:bg-white/30 transition-all duration-300",onClick:()=>{if(j){var e;null===(e=f.current)||void 0===e||e.click()}},whileHover:{scale:1.1},whileTap:{scale:.95},children:"+"})}),0===m.length&&(0,a.jsx)("div",{className:"absolute inset-0 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCC1"}),(0,a.jsx)("div",{className:"text-sm",children:j?"클릭하여 이미지 추가":"이미지 없음"})]})})]}),(0,a.jsx)("input",{ref:f,type:"file",multiple:!0,accept:"image/*",onChange:e=>{let l=e.target.files;l&&N(l)},className:"hidden"})]})}var h=t(59909);function u(){let[e,l]=(0,i.useState)([{id:"1",src:"/images/designer-placeholder.jpg",alt:"Test 1"},{id:"2",src:"/images/designer-placeholder.jpg",alt:"Test 2"},{id:"3",src:"/images/designer-placeholder.jpg",alt:"Test 3"},{id:"4",src:"/images/designer-placeholder.jpg",alt:"Test 4"},{id:"5",src:"/images/designer-placeholder.jpg",alt:"Test 5"}]);return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)(h.A,{}),(0,a.jsxs)("div",{className:"pt-24 px-8",children:[(0,a.jsx)("h1",{className:"text-4xl mb-8",children:"Stack Gallery Test"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl mb-4",children:"Gallery 1"}),(0,a.jsx)(o,{images:e,folder:"test/gallery1",className:"w-full",maxVisible:3,onImagesUpdate:l})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl mb-4",children:"Gallery 2"}),(0,a.jsx)(o,{images:[{id:"1",src:"/images/designer-placeholder.jpg",alt:"Gallery 2-1"},{id:"2",src:"/images/designer-placeholder.jpg",alt:"Gallery 2-2"},{id:"3",src:"/images/designer-placeholder.jpg",alt:"Gallery 2-3"}],folder:"test/gallery2",className:"w-full",maxVisible:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl mb-4",children:"Gallery 3 (Empty)"}),(0,a.jsx)(o,{images:[],folder:"test/gallery3",className:"w-full",maxVisible:3})]})]}),(0,a.jsxs)("div",{className:"mt-16 max-w-2xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl mb-4",children:"테스트 안내"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[(0,a.jsx)("li",{children:"마우스를 올리면 스택 효과가 나타납니다"}),(0,a.jsx)("li",{children:"관리자 모드에서는 + 버튼으로 이미지를 추가할 수 있습니다"}),(0,a.jsx)("li",{children:"각 이미지의 \xd7 버튼으로 삭제할 수 있습니다"}),(0,a.jsx)("li",{children:"Gallery 1은 5개 이미지 중 3개만 표시되고 +2 표시가 나타납니다"}),(0,a.jsx)("li",{children:"Gallery 3은 비어있는 상태로 시작합니다"})]})]})]})]})}},91653:(e,l,t)=>{"use strict";t.d(l,{A:()=>d});var a=t(95155),i=t(12115),s=t(25427),r=t(5565),n=t(33227),c=t(86989);function d(e){let{src:l,alt:t,className:d="",folder:o,sizes:h,fill:u=!1,width:m,height:x,priority:p=!1}=e,[g,f]=(0,i.useState)(l),[j,y]=(0,i.useState)(!1),[b,v]=(0,i.useState)(!1),w=(0,i.useRef)(null),{isAdmin:N}=(0,c.z)(),{success:k,error:P}=(0,n.d)(),C=async e=>{if(e){y(!0);try{let l=new FormData;l.append("file",e),l.append("folder",o);let t=await fetch("/api/imagekit/upload",{method:"POST",body:l});if(t.ok){let e=await t.json();f(e.url),k("이미지가 성공적으로 업로드되었습니다.")}else throw Error("Upload failed")}catch(e){P("이미지 업로드에 실패했습니다.")}finally{y(!1)}}},T=()=>{if(N){var e;null===(e=w.current)||void 0===e||e.click()}};return(0,a.jsxs)("div",{className:"relative group ".concat(d),children:[(0,a.jsx)(r.default,{src:b?"/images/designer-placeholder.jpg":g,alt:t,fill:u,width:u?void 0:m,height:u?void 0:x,sizes:h,priority:p,className:"".concat(d," ").concat(N?"cursor-pointer":""),onClick:T,onError:()=>{v(!0)}}),N&&(0,a.jsx)(s.P.div,{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",whileHover:{opacity:1},children:j?(0,a.jsx)(s.P.div,{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}):(0,a.jsx)(s.P.button,{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-all duration-300",whileHover:{scale:1.1},whileTap:{scale:.95},onClick:T,children:"\uD83D\uDCC1"})}),(0,a.jsx)("input",{ref:w,type:"file",accept:"image/*",onChange:e=>{var l;let t=null===(l=e.target.files)||void 0===l?void 0:l[0];t&&C(t)},className:"hidden"})]})}}},e=>{var l=l=>e(e.s=l);e.O(0,[427,565,173,415,441,517,358],()=>l(36708)),_N_E=e.O()}]);