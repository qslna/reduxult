"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[183],{183:(e,t,s)=>{s.d(t,{A:()=>w});var a=s(5155),l=s(2115),i=s(9219),r=s(5683),c=s(7820),n=s(7078),o=s(738),d=s(2598),u=s(5440),m=s(3473),h=s(5686),x=s(8867),p=s(6527),g=s(8684),b=s(767),v=s(5565),f=s(3271);let j=e=>({1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",4:"grid-cols-2 lg:grid-cols-4",5:"grid-cols-2 lg:grid-cols-5",6:"grid-cols-3 lg:grid-cols-6"})[e]||"grid-cols-3",N=e=>({square:"aspect-square","4:3":"aspect-[4/3]","16:9":"aspect-video","4:5":"aspect-[4/5]",auto:"aspect-auto"})[e]||"aspect-square",w=e=>{let{galleryId:t,initialItems:s=[],onUpdate:w,maxItems:y=50,allowedTypes:k=["image","video"],aspectRatio:A="square",columns:C=3}=e,{isAdmin:S}=(0,f.b)(),[D,P]=(0,l.useState)(s),[z,M]=(0,l.useState)(new Set),[T,L]=(0,l.useState)(!1),[_,q]=(0,l.useState)(!1),[E,H]=(0,l.useState)(!1),[R,F]=(0,l.useState)(null),[G,U]=(0,l.useState)(!1),O=(0,l.useRef)(null),B=(0,l.useRef)(null),I=(0,l.useCallback)(e=>!!(k.includes("image")&&["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)||k.includes("video")&&["video/mp4","video/webm","video/mov"].includes(e.type)),[k]),W=(0,l.useCallback)(async e=>{if(!e.length)return;H(!0);let t=[];for(let s=0;s<e.length;s++){let a=e[s];if(I(a))try{let e=URL.createObjectURL(a),l={id:"temp_".concat(Date.now(),"_").concat(s),url:e,type:a.type.startsWith("video/")?"video":"image",filename:a.name,size:a.size,createdAt:new Date,alt:a.name.replace(/\.[^/.]+$/,"")};t.push(l)}catch(e){}}let s=[...D,...t].slice(0,y);P(s),null==w||w(s),H(!1)},[D,y,w,I]),$=(0,l.useCallback)(e=>{e.preventDefault(),q(!0)},[]),J=(0,l.useCallback)(e=>{var t;e.preventDefault(),(null===(t=B.current)||void 0===t?void 0:t.contains(e.relatedTarget))||q(!1)},[]),K=(0,l.useCallback)(e=>{e.preventDefault(),q(!1),W(e.dataTransfer.files)},[W]);if(!S)return(0,a.jsx)("div",{className:"grid gap-2 ".concat(j(C)),children:D.map((e,t)=>(0,a.jsxs)(i.P.div,{className:"relative ".concat(N(A)," cursor-pointer group overflow-hidden rounded-lg"),initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.02},transition:{delay:.1*t},onClick:()=>F(e),children:["image"===e.type?(0,a.jsx)(v.default,{src:e.url,alt:e.alt||e.filename,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-300",sizes:"(max-width: 768px) 50vw, 33vw"}):(0,a.jsx)("video",{src:e.url,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",muted:!0,loop:!0,onMouseEnter:e=>e.currentTarget.play(),onMouseLeave:e=>e.currentTarget.pause()}),"video"===e.type&&(0,a.jsx)("div",{className:"absolute top-2 right-2 bg-black/50 rounded-full p-1",children:(0,a.jsx)(c.A,{className:"w-4 h-4 text-white"})})]},e.id))});let Q=e=>{let t=new Set(z);t.has(e)?t.delete(e):t.add(e),M(t)},V=e=>{let t=D.filter(t=>t.id!==e);P(t),null==w||w(t)};return(0,a.jsxs)("div",{className:"instagram-cms",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-white",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(n.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium",children:"Gallery Manager"}),(0,a.jsxs)("span",{className:"text-xs bg-white/20 px-2 py-1 rounded-full",children:[D.length,"/",y]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>U(!G),className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors",title:G?"Hide Grid":"Show Grid",children:G?(0,a.jsx)(o.A,{className:"w-4 h-4"}):(0,a.jsx)(d.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>L(!T),className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors",title:"Selection Mode",children:(0,a.jsx)(u.A,{className:"w-4 h-4"})}),(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},className:"flex items-center gap-2 bg-white text-purple-500 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors font-medium",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Add"]})]})]}),(0,a.jsx)(r.N,{children:T&&(0,a.jsx)(i.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-4 p-3 bg-gray-100 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[z.size," selected"]}),(0,a.jsx)("button",{onClick:()=>{M(new Set(D.map(e=>e.id)))},className:"text-xs text-blue-600 hover:text-blue-800",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{M(new Set)},className:"text-xs text-gray-600 hover:text-gray-800",children:"Deselect All"})]}),z.size>0&&(0,a.jsxs)("button",{onClick:()=>{let e=D.filter(e=>!z.has(e.id));P(e),null==w||w(e),M(new Set),L(!1)},className:"flex items-center gap-2 bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 transition-colors text-sm",children:[(0,a.jsx)(h.A,{className:"w-4 h-4"}),"Delete Selected"]})]})})}),(0,a.jsxs)("div",{ref:B,onDragOver:$,onDragLeave:J,onDrop:K,className:"relative ".concat(j(C)," gap-3 p-4 rounded-lg transition-all duration-300 ").concat(_?"bg-blue-50 border-2 border-dashed border-blue-400":"bg-transparent"),children:[0===D.length&&!E&&(0,a.jsxs)("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-gray-500",children:[(0,a.jsx)(n.A,{className:"w-12 h-12 mb-4 opacity-50"}),(0,a.jsx)("p",{className:"text-lg font-medium mb-2",children:"No media yet"}),(0,a.jsx)("p",{className:"text-sm mb-4",children:"Drag and drop files here or click the Add button"}),(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},className:"flex items-center gap-2 bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-colors",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Add First Image"]})]}),D.map((e,t)=>(0,a.jsxs)(i.P.div,{className:"relative ".concat(N(A)," group cursor-pointer overflow-hidden rounded-lg ").concat(z.has(e.id)?"ring-4 ring-blue-500":""),initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.02},transition:{delay:.05*t},onClick:()=>{T?Q(e.id):F(e)},children:["image"===e.type?(0,a.jsx)(v.default,{src:e.url,alt:e.alt||e.filename,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-300",sizes:"(max-width: 768px) 50vw, 33vw"}):(0,a.jsx)("video",{src:e.url,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",muted:!0,loop:!0,onMouseEnter:e=>e.currentTarget.play(),onMouseLeave:e=>e.currentTarget.pause()}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:(0,a.jsx)("div",{className:"flex gap-2",children:T?(0,a.jsx)("button",{className:"p-2 rounded-full transition-colors ".concat(z.has(e.id)?"bg-blue-500 text-white":"bg-white/20 text-white hover:bg-white/30"),children:(0,a.jsx)(x.A,{className:"w-4 h-4"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),F(e)},className:"p-2 bg-white/20 text-white rounded-full hover:bg-white/30 transition-colors",children:(0,a.jsx)(d.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),V(e.id)},className:"p-2 bg-red-500/80 text-white rounded-full hover:bg-red-500 transition-colors",children:(0,a.jsx)(p.A,{className:"w-4 h-4"})})]})})}),"video"===e.type&&(0,a.jsx)("div",{className:"absolute top-2 right-2 bg-black/50 rounded-full p-1 opacity-80",children:(0,a.jsx)(c.A,{className:"w-4 h-4 text-white"})}),T&&(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(0,a.jsx)("input",{type:"checkbox",checked:z.has(e.id),onChange:()=>Q(e.id),className:"w-5 h-5 rounded border-2 border-white bg-white/20 text-blue-500 focus:ring-blue-500 focus:ring-2"})})]},e.id)),D.length>0&&D.length<y&&(0,a.jsx)(i.P.button,{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},className:"".concat(N(A)," border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-purple-400 hover:bg-purple-50 transition-colors group"),whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(m.A,{className:"w-8 h-8 mx-auto mb-2 text-gray-400 group-hover:text-purple-500"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 group-hover:text-purple-600",children:"Add Media"})]})}),(0,a.jsx)(r.N,{children:_&&(0,a.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-blue-100/80 backdrop-blur-sm border-2 border-dashed border-blue-400 rounded-lg flex items-center justify-center z-10",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.A,{className:"w-12 h-12 mx-auto mb-4 text-blue-500"}),(0,a.jsx)("p",{className:"text-xl font-medium text-blue-700 mb-2",children:"Drop files here"}),(0,a.jsx)("p",{className:"text-blue-600",children:"Support images and videos"})]})})})]}),(0,a.jsx)(r.N,{children:E&&(0,a.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4 text-center",children:[(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,a.jsx)("p",{className:"font-medium mb-2",children:"Uploading media..."}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Please wait while we process your files"})]})})}),(0,a.jsx)(r.N,{children:R&&(0,a.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>F(null),children:(0,a.jsxs)(i.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{onClick:()=>F(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300 transition-colors",children:(0,a.jsx)(b.A,{className:"w-8 h-8"})}),"image"===R.type?(0,a.jsx)(v.default,{src:R.url,alt:R.alt||R.filename,width:1200,height:800,className:"max-w-full max-h-full object-contain rounded-lg",sizes:"100vw"}):(0,a.jsx)("video",{src:R.url,controls:!0,className:"max-w-full max-h-full rounded-lg",autoPlay:!0}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 rounded-b-lg",children:[(0,a.jsx)("p",{className:"text-white font-medium",children:R.filename}),(0,a.jsxs)("p",{className:"text-gray-300 text-sm",children:[(R.size/1024/1024).toFixed(2)," MB â€¢ ",R.createdAt.toLocaleDateString()]})]})]})})}),(0,a.jsx)("input",{ref:O,type:"file",multiple:!0,accept:k.includes("image")&&k.includes("video")?"image/*,video/*":k.includes("image")?"image/*":"video/*",onChange:e=>e.target.files&&W(e.target.files),className:"hidden"})]})}}}]);