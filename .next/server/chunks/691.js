"use strict";exports.id=691,exports.ids=[691],exports.modules={43286:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(41680).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},26691:(e,t,a)=>{a.d(t,{A:()=>y});var s=a(45512),i=a(58009),l=a(45103),r=a(67418),n=a(43286),o=a(12592),d=a(21956),c=a(49656),u=a(44269),m=a(72744),p=a(24849),h=a(6648),x=a(31700),g=a(40953),b=a(85457);let f={publicKey:"public_2BXoL4/MDWL0GjI21rq6iIG1TF8="};async function j(e,t={}){try{let a=await fetch("/api/imagekit/auth");if(!a.ok)throw Error("Failed to get authentication parameters");let s=await a.json(),i=new FormData;i.append("file",e),i.append("publicKey",f.publicKey),i.append("signature",s.signature),i.append("expire",s.expire),i.append("token",s.token),t.fileName&&i.append("fileName",t.fileName),t.folder&&i.append("folder",t.folder),void 0!==t.useUniqueFileName&&i.append("useUniqueFileName",t.useUniqueFileName.toString()),t.tags&&t.tags.length>0&&i.append("tags",t.tags.join(",")),t.customMetadata&&i.append("customMetadata",JSON.stringify(t.customMetadata));let l=new XMLHttpRequest;return new Promise(e=>{l.upload.addEventListener("progress",e=>{if(e.lengthComputable&&t.onProgress){let a=Math.round(e.loaded/e.total*100);t.onProgress(a)}}),l.addEventListener("load",()=>{try{if(200===l.status){let t=JSON.parse(l.responseText);e({success:!0,url:t.url,fileId:t.fileId,width:t.width,height:t.height})}else{let t=JSON.parse(l.responseText);e({success:!1,error:t.message||"Upload failed"})}}catch{e({success:!1,error:"Failed to parse response"})}}),l.addEventListener("error",()=>{e({success:!1,error:"Network error during upload"})}),l.open("POST","https://upload.imagekit.io/api/v1/files/upload"),l.send(i)})}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}function y({src:e,alt:t,className:a="",sizes:f="100vw",onUpdate:y,onDelete:N,category:w="general",priority:v=!1,quality:k=85,showEditButton:z=!0,aspectRatio:$,placeholder:A="empty",blurDataURL:I,enableCMS:P=!0,mediaId:S}){let{isAdmin:U}=(0,g.A)(),{addMedia:C,deleteMedia:D,addActivity:E,addError:F}=(0,b.A)(),[M,L]=(0,i.useState)(!1),[T,q]=(0,i.useState)(!1),[O,R]=(0,i.useState)(0),[_,G]=(0,i.useState)(null),[J,W]=(0,i.useState)(!1),[K,B]=(0,i.useState)(e),V=(0,i.useRef)(null),X=(0,i.useCallback)(e=>{let t=e.target.files?.[0];if(t){if(!["image/jpeg","image/jpg","image/png","image/webp","image/avif"].includes(t.type)){G("Invalid file type. Please select a JPEG, PNG, WebP, or AVIF image.");return}if(t.size>0xa00000){G("File size too large. Please select an image under 10MB.");return}H(t)}},[]),H=async e=>{q(!0),R(0),G(null);try{let a=`img_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s=await j(e,{folder:w,fileName:`${a}_${e.name}`,useUniqueFileName:!0,onProgress:e=>{R(e)}});if(s.success&&s.url){let i={id:a,url:s.url,type:"image",alt:t||e.name,title:e.name,category:w,folder:w,width:s.width||0,height:s.height||0,size:e.size,uploadedAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tags:[],metadata:{originalName:e.name,fileType:e.type,...s}};P&&(C(i),E({userId:"admin",action:"upload",entityType:"media",entityId:i.id,details:`Uploaded image: ${e.name} to ${w}`})),B(s.url),y&&y(s.url),R(100),setTimeout(()=>{q(!1),R(0)},1e3)}else throw Error(s.error||"Upload failed")}catch(t){G(t instanceof Error?t.message:"Upload failed"),F(`Failed to upload ${e.name}: ${t instanceof Error?t.message:"Unknown error"}`),q(!1),R(0)}},Q=e=>{if(!e)return"/images/placeholder.jpg";if(e.startsWith("http"))return e;let t="https://ik.imagekit.io/t914/";return t?`${t}${e.startsWith("/")?e:`/${e}`}?w=1920&q=${k}&f=auto`:e};return U?(0,s.jsxs)("div",{className:`relative group ${$?`aspect-[${$}]`:""} ${a}`,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),children:[(0,s.jsx)("input",{ref:V,type:"file",accept:"image/*",onChange:X,className:"hidden"}),(0,s.jsx)(l.default,{src:Q(K),alt:t,fill:!0,className:"object-cover transition-all duration-300 group-hover:brightness-75",sizes:f,priority:v,quality:k,placeholder:A,blurDataURL:I,onError:()=>B("/images/placeholder.jpg")}),(0,s.jsx)(h.N,{children:T&&(0,s.jsx)(x.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-20",children:(0,s.jsxs)("div",{className:"text-center text-white",children:[(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mb-4 mx-auto"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:"Uploading..."}),(0,s.jsxs)("p",{className:"text-xs text-gray-300 mt-1",children:[O,"%"]}),(0,s.jsx)("div",{className:"w-32 h-1 bg-white/30 rounded-full mt-2 overflow-hidden",children:(0,s.jsx)(x.P.div,{className:"h-full bg-white rounded-full",initial:{width:"0%"},animate:{width:`${O}%`},transition:{duration:.3}})})]})})}),(0,s.jsx)(h.N,{children:_&&(0,s.jsx)(x.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute inset-0 bg-red-500/90 backdrop-blur-sm flex items-center justify-center z-20",children:(0,s.jsxs)("div",{className:"text-center text-white p-4",children:[(0,s.jsx)(r.A,{size:24,className:"mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm font-medium mb-2",children:"Upload Error"}),(0,s.jsx)("p",{className:"text-xs",children:_}),(0,s.jsx)("button",{onClick:()=>G(null),className:"mt-2 px-3 py-1 bg-white/20 rounded-lg text-xs hover:bg-white/30 transition-colors",children:"Dismiss"})]})})}),(0,s.jsx)(h.N,{children:M&&z&&!T&&(0,s.jsx)(x.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-10",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>{V.current?.click()},className:"p-2 bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors",title:"Replace Image",children:(0,s.jsx)(n.A,{size:16,className:"text-white"})}),P&&S&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{P&&S&&E({userId:"admin",action:"edit",entityType:"media",entityId:S,details:`Duplicated image: ${t}`})},className:"p-2 bg-green-500 hover:bg-green-600 rounded-lg transition-colors",title:"Duplicate Image",children:(0,s.jsx)(o.A,{size:16,className:"text-white"})}),(0,s.jsx)("button",{onClick:()=>W(!J),className:"p-2 bg-purple-500 hover:bg-purple-600 rounded-lg transition-colors",title:"More Actions",children:(0,s.jsx)(d.A,{size:16,className:"text-white"})})]}),N&&(0,s.jsx)("button",{onClick:()=>{N&&N(),P&&S&&(D(S),E({userId:"admin",action:"delete",entityType:"media",entityId:S,details:`Deleted image: ${t}`}))},className:"p-2 bg-red-500 hover:bg-red-600 rounded-lg transition-colors",title:"Delete Image",children:(0,s.jsx)(c.A,{size:16,className:"text-white"})})]})})}),(0,s.jsx)(h.N,{children:J&&P&&(0,s.jsxs)(x.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute top-4 right-4 bg-black/90 backdrop-blur-sm rounded-lg p-3 z-30 min-w-48",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h4",{className:"text-white text-sm font-medium",children:"Image Actions"}),(0,s.jsx)("button",{onClick:()=>W(!1),className:"text-gray-400 hover:text-white",children:(0,s.jsx)(u.A,{size:14})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(K),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-white hover:bg-white/10 rounded transition-colors",children:[(0,s.jsx)(o.A,{size:12}),"Copy URL"]}),(0,s.jsxs)("button",{onClick:()=>window.open(K,"_blank"),className:"w-full flex items-center gap-2 px-3 py-2 text-xs text-white hover:bg-white/10 rounded transition-colors",children:[(0,s.jsx)(d.A,{size:12}),"View Full Size"]}),(0,s.jsxs)("div",{className:"border-t border-gray-600 pt-2",children:[(0,s.jsxs)("p",{className:"text-xs text-gray-400 mb-1",children:["Category: ",w]}),S&&(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["ID: ",S]})]})]})]})}),T&&(0,s.jsx)("div",{className:"absolute top-2 right-2 z-30",children:(0,s.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:(0,s.jsx)(m.A,{size:12,className:"text-white"})})}),100===O&&(0,s.jsx)(x.P.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute top-2 right-2 z-30",children:(0,s.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,s.jsx)(p.A,{size:12,className:"text-white"})})})]}):(0,s.jsx)("div",{className:`relative ${$?`aspect-[${$}]`:""} ${a}`,children:(0,s.jsx)(l.default,{src:Q(K),alt:t,fill:!0,className:"object-cover",sizes:f,priority:v,quality:k,placeholder:A,blurDataURL:I,onError:()=>B("/images/placeholder.jpg")})})}}};